<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Gamified Tree-Planting ‚Äî EnergiChain</title>
  <link rel="stylesheet" href="../styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    .planting-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
      margin-top: 2rem;
    }
    
    .tree-progress {
      text-align: center;
      padding: 3rem;
      background: linear-gradient(135deg, rgba(0,255,136,0.1) 0%, rgba(0,200,100,0.1) 100%);
      border: 2px solid var(--accent);
      border-radius: 20px;
      position: relative;
      overflow: hidden;
    }
    
    .tree-animation {
      font-size: 8rem;
      margin: 2rem 0;
      filter: drop-shadow(0 0 20px var(--accent));
      animation: treeGrow 3s ease-in-out infinite;
    }
    
    @keyframes treeGrow {
      0%, 100% { transform: scale(1) rotate(0deg); }
      25% { transform: scale(1.05) rotate(-2deg); }
      75% { transform: scale(1.05) rotate(2deg); }
    }
    
    .progress-ring {
      width: 200px;
      height: 200px;
      margin: 2rem auto;
      position: relative;
    }
    
    .progress-ring svg {
      transform: rotate(-90deg);
    }
    
    .progress-ring-circle {
      stroke: #333;
      fill: none;
      stroke-width: 12;
    }
    
    .progress-ring-progress {
      stroke: var(--accent);
      fill: none;
      stroke-width: 12;
      stroke-linecap: round;
      stroke-dasharray: 565;
      stroke-dashoffset: 565;
      transition: stroke-dashoffset 1s ease;
    }
    
    .progress-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 2.5rem;
      font-weight: 800;
      color: var(--accent);
    }
    
    .reward-card {
      background: rgba(0,0,0,0.3);
      border: 2px solid transparent;
      border-radius: 15px;
      padding: 1.5rem;
      text-align: center;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .reward-card.unlocked {
      border-color: var(--accent);
      background: rgba(0,255,136,0.1);
      animation: rewardUnlock 0.6s ease-out;
    }
    
    @keyframes rewardUnlock {
      0% { transform: scale(0.8); opacity: 0; }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); opacity: 1; }
    }
    
    .reward-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
      filter: grayscale(100%);
      opacity: 0.3;
      transition: all 0.3s ease;
    }
    
    .reward-card.unlocked .reward-icon {
      filter: grayscale(0%);
      opacity: 1;
      animation: iconBounce 0.8s ease-out;
    }
    
    @keyframes iconBounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
    }
    
    .plant-button {
      padding: 2rem 3rem;
      font-size: 1.5rem;
      background: linear-gradient(135deg, var(--accent), #00c864);
      color: #000;
      font-weight: 800;
      border-radius: 50px;
      border: none;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 10px 30px rgba(0,255,136,0.3);
      position: relative;
      overflow: hidden;
    }
    
    .plant-button:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(0,255,136,0.5);
    }
    
    .plant-button:active {
      transform: translateY(-2px);
    }
    
    .plant-button::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255,255,255,0.5);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }
    
    .plant-button:active::before {
      width: 300px;
      height: 300px;
    }
    
    .map-view {
      background: #0a0a0a;
      border-radius: 15px;
      height: 400px;
      position: relative;
      overflow: hidden;
      border: 2px solid #333;
    }
    
    .tree-marker {
      position: absolute;
      width: 30px;
      height: 30px;
      background: var(--accent);
      border-radius: 50%;
      border: 3px solid #000;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      animation: markerPop 0.5s ease-out;
      transition: all 0.3s ease;
    }
    
    .tree-marker:hover {
      transform: scale(1.3);
      z-index: 10;
    }
    
    @keyframes markerPop {
      0% { transform: scale(0); }
      50% { transform: scale(1.3); }
      100% { transform: scale(1); }
    }
    
    .partner-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      background: rgba(0,0,0,0.5);
      border: 1px solid var(--accent);
      border-radius: 20px;
      margin: 0.5rem;
      font-size: 0.85rem;
    }
    
    .leaderboard-entry {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      background: rgba(0,0,0,0.3);
      border-radius: 10px;
      margin-bottom: 0.75rem;
      transition: all 0.3s ease;
    }
    
    .leaderboard-entry:hover {
      background: rgba(0,255,136,0.1);
      transform: translateX(5px);
    }
    
    .rank-badge {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 1.2rem;
    }
    
    .rank-1 { background: linear-gradient(135deg, #ffd700, #ffed4e); color: #000; }
    .rank-2 { background: linear-gradient(135deg, #c0c0c0, #e8e8e8); color: #000; }
    .rank-3 { background: linear-gradient(135deg, #cd7f32, #e8a76f); color: #000; }
    .rank-other { background: rgba(0,255,136,0.2); color: var(--accent); }
    
    .notification {
      position: fixed;
      top: 100px;
      right: 2rem;
      background: linear-gradient(135deg, var(--accent), #00c864);
      color: #000;
      padding: 1.5rem 2rem;
      border-radius: 15px;
      box-shadow: 0 10px 40px rgba(0,255,136,0.5);
      font-weight: 700;
      font-size: 1.1rem;
      z-index: 1000;
      animation: slideIn 0.5s ease-out, slideOut 0.5s ease-in 4s;
      display: none;
    }
    
    .notification.show {
      display: block;
    }
    
    @keyframes slideIn {
      from { transform: translateX(400px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    
    @keyframes slideOut {
      from { transform: translateX(0); opacity: 1; }
      to { transform: translateX(400px); opacity: 0; }
    }
    
    @media (max-width: 768px) {
      .planting-container {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <header class="site-header">
    <div style="display:flex;align-items:center;gap:1rem">
      <div class="brand">EnergiChain</div>
      <span style="font-size:0.9rem;color:#666">|</span>
      <span style="font-size:0.9rem;color:#999">Tree Planting Program</span>
    </div>
    <nav>
      <a href="index.html" style="display:flex;align-items:center;gap:0.5rem">
        ‚Üê Dashboard
      </a>
    </nav>
  </header>
  
  <main style="padding:2rem;max-width:1400px;margin:0 auto">
    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <!-- Header Section -->
    <div style="text-align:center;margin-bottom:3rem">
      <h1 style="font-size:2.5rem;margin-bottom:1rem;background:linear-gradient(135deg,var(--accent),#00c864);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text">
        üå≥ Plant a Tree, Earn a Refill
      </h1>
      <p style="font-size:1.1rem;color:#999;line-height:1.6">
        Join our gamified reforestation program and earn rewards for every tree planted
      </p>
    </div>

    <!-- Stats Bar -->
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1.5rem;margin-bottom:2rem">
      <div style="padding:1.5rem;background:rgba(0,0,0,0.3);border:1px solid #333;border-radius:12px;text-align:center">
        <div style="font-size:2rem;font-weight:700;color:var(--accent)" id="totalTrees">3,847</div>
        <div style="font-size:0.85rem;color:#999;margin-top:0.5rem">Trees Planted</div>
      </div>
      <div style="padding:1.5rem;background:rgba(0,0,0,0.3);border:1px solid #333;border-radius:12px;text-align:center">
        <div style="font-size:2rem;font-weight:700;color:var(--accent)" id="yourTrees">12</div>
        <div style="font-size:0.85rem;color:#999;margin-top:0.5rem">Your Trees</div>
      </div>
      <div style="padding:1.5rem;background:rgba(0,0,0,0.3);border:1px solid #333;border-radius:12px;text-align:center">
        <div style="font-size:2rem;font-weight:700;color:var(--accent)" id="yourPoints">1,200</div>
        <div style="font-size:0.85rem;color:#999;margin-top:0.5rem">Green Points</div>
      </div>
      <div style="padding:1.5rem;background:rgba(0,0,0,0.3);border:1px solid #333;border-radius:12px;text-align:center">
        <div style="font-size:2rem;font-weight:700;color:var(--accent)">1.2 ha</div>
        <div style="font-size:0.85rem;color:#999;margin-top:0.5rem">Land Restored</div>
      </div>
    </div>

    <!-- Main Planting Interface -->
    <div class="planting-container">
      <!-- Tree Planting Section -->
      <div>
        <div class="tree-progress">
          <div style="position:absolute;top:0;left:0;right:0;height:150px;background:linear-gradient(180deg,var(--accent),transparent);opacity:0.1"></div>
          
          <div style="position:relative;z-index:1">
            <div style="font-size:1.2rem;font-weight:700;color:var(--accent);margin-bottom:1rem">
              üéØ Progress to Free Refill
            </div>
            
            <div class="progress-ring">
              <svg width="200" height="200">
                <circle class="progress-ring-circle" cx="100" cy="100" r="90"></circle>
                <circle class="progress-ring-progress" id="progressCircle" cx="100" cy="100" r="90"></circle>
              </svg>
              <div class="progress-text" id="progressText">12/15</div>
            </div>
            
            <div style="font-size:1rem;color:#ccc;margin-bottom:2rem">
              Plant <strong style="color:var(--accent)">3 more trees</strong> to unlock a free 13kg refill!
            </div>
            
            <div class="tree-animation" id="treeIcon">üå≤</div>
            
            <button class="plant-button" onclick="plantTree()">
              <span style="position:relative;z-index:1">üå± Plant a Tree Now</span>
            </button>
            
            <div style="margin-top:2rem;font-size:0.9rem;color:#999">
              <div>üìç Location: Auto-detected via GPS</div>
              <div>üí∞ Cost: 100 Green Points</div>
              <div>‚è±Ô∏è Verification: 24-48 hours</div>
            </div>
          </div>
        </div>
        
        <!-- Partner Organizations -->
        <div class="action-panel" style="margin-top:2rem">
          <h3>ü§ù Partner Organizations</h3>
          <div style="margin-top:1rem">
            <div class="partner-badge">
              üåç Kenya Forest Service
            </div>
            <div class="partner-badge">
              üå≤ Green Belt Movement
            </div>
            <div class="partner-badge">
              üå≥ One Tree Planted
            </div>
            <div class="partner-badge">
              üåø Treedom Kenya
            </div>
          </div>
        </div>
      </div>

      <!-- Rewards & Map Section -->
      <div>
        <!-- Rewards -->
        <div class="action-panel" style="margin-bottom:2rem">
          <h3>üéÅ Unlock Rewards</h3>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-top:1rem">
            <div class="reward-card unlocked">
              <div class="reward-icon">üéâ</div>
              <div style="font-weight:700;margin-bottom:0.5rem">Starter Badge</div>
              <div style="font-size:0.8rem;color:#999">5 trees</div>
              <div style="margin-top:0.5rem;color:var(--accent);font-weight:600">‚úì UNLOCKED</div>
            </div>
            
            <div class="reward-card unlocked">
              <div class="reward-icon">üå±</div>
              <div style="font-weight:700;margin-bottom:0.5rem">Seedling</div>
              <div style="font-size:0.8rem;color:#999">10 trees</div>
              <div style="margin-top:0.5rem;color:var(--accent);font-weight:600">‚úì UNLOCKED</div>
            </div>
            
            <div class="reward-card" id="reward15">
              <div class="reward-icon">‚õΩ</div>
              <div style="font-weight:700;margin-bottom:0.5rem">Free Refill</div>
              <div style="font-size:0.8rem;color:#999">15 trees</div>
              <div style="margin-top:0.5rem;color:#666">3 more trees</div>
            </div>
            
            <div class="reward-card">
              <div class="reward-icon">üèÜ</div>
              <div style="font-weight:700;margin-bottom:0.5rem">Forest Hero</div>
              <div style="font-size:0.8rem;color:#999">50 trees</div>
              <div style="margin-top:0.5rem;color:#666">38 more trees</div>
            </div>
            
            <div class="reward-card">
              <div class="reward-icon">üåç</div>
              <div style="font-weight:700;margin-bottom:0.5rem">Climate Champion</div>
              <div style="font-size:0.8rem;color:#999">100 trees</div>
              <div style="margin-top:0.5rem;color:#666">88 more trees</div>
            </div>
            
            <div class="reward-card">
              <div class="reward-icon">üëë</div>
              <div style="font-weight:700;margin-bottom:0.5rem">Tree King/Queen</div>
              <div style="font-size:0.8rem;color:#999">250 trees</div>
              <div style="margin-top:0.5rem;color:#666">238 more trees</div>
            </div>
          </div>
        </div>

        <!-- Interactive Map -->
        <div class="action-panel">
          <h3>üó∫Ô∏è Your Tree Locations</h3>
          <div class="map-view" id="treeMap">
            <!-- Map background with grid -->
            <svg style="position:absolute;width:100%;height:100%;opacity:0.1" xmlns="http://www.w3.org/2000/svg">
              <defs>
                <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
                  <path d="M 40 0 L 0 0 0 40" fill="none" stroke="#00ff88" stroke-width="0.5"/>
                </pattern>
              </defs>
              <rect width="100%" height="100%" fill="url(#grid)" />
            </svg>
            
            <!-- Kenya outline -->
            <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:8rem;opacity:0.05">
              üó∫Ô∏è
            </div>
            
            <!-- Tree markers will be added here -->
            <div id="treeMarkers"></div>
          </div>
          <div style="margin-top:1rem;text-align:center;font-size:0.85rem;color:#999">
            Click markers to see tree details ‚Ä¢ GPS verified locations
          </div>
        </div>
      </div>
    </div>

    <!-- Leaderboard -->
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:2rem;margin-top:2rem">
      <div class="action-panel">
        <h3>üèÜ Top Planters (This Month)</h3>
        <div style="margin-top:1rem">
          <div class="leaderboard-entry">
            <div class="rank-badge rank-1">1</div>
            <div style="flex:1">
              <div style="font-weight:700">Sarah Njeri</div>
              <div style="font-size:0.8rem;color:#999">Nairobi</div>
            </div>
            <div style="font-weight:700;color:var(--accent)">47 üå≤</div>
          </div>
          
          <div class="leaderboard-entry">
            <div class="rank-badge rank-2">2</div>
            <div style="flex:1">
              <div style="font-weight:700">John Kamau</div>
              <div style="font-size:0.8rem;color:#999">Mombasa</div>
            </div>
            <div style="font-weight:700;color:var(--accent)">38 üå≤</div>
          </div>
          
          <div class="leaderboard-entry">
            <div class="rank-badge rank-3">3</div>
            <div style="flex:1">
              <div style="font-weight:700">Mary Wanjiku</div>
              <div style="font-size:0.8rem;color:#999">Kisumu</div>
            </div>
            <div style="font-weight:700;color:var(--accent)">32 üå≤</div>
          </div>
          
          <div class="leaderboard-entry" style="background:rgba(0,255,136,0.1);border:2px solid var(--accent)">
            <div class="rank-badge rank-other">8</div>
            <div style="flex:1">
              <div style="font-weight:700;color:var(--accent)">You</div>
              <div style="font-size:0.8rem;color:#999">Navalur</div>
            </div>
            <div style="font-weight:700;color:var(--accent)">12 üå≤</div>
          </div>
        </div>
      </div>

      <!-- Impact Chart -->
      <div class="action-panel">
        <h3>üìä Monthly Planting Progress</h3>
        <div class="chart-container" style="height:300px;margin-top:1rem">
          <canvas id="plantingChart"></canvas>
        </div>
      </div>
    </div>

    <!-- How It Works -->
    <div class="action-panel" style="margin-top:2rem">
      <h3>üå± How It Works</h3>
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:2rem;margin-top:1.5rem">
        <div style="text-align:center;padding:1.5rem">
          <div style="font-size:3rem;margin-bottom:1rem">1Ô∏è‚É£</div>
          <div style="font-size:1.1rem;font-weight:700;margin-bottom:0.5rem">Plant a Tree</div>
          <div style="color:#999;font-size:0.9rem">Use 100 Green Points or partner with local organizations</div>
        </div>
        
        <div style="text-align:center;padding:1.5rem">
          <div style="font-size:3rem;margin-bottom:1rem">2Ô∏è‚É£</div>
          <div style="font-size:1.1rem;font-weight:700;margin-bottom:0.5rem">GPS Verification</div>
          <div style="color:#999;font-size:0.9rem">Location tracked via blockchain for transparency</div>
        </div>
        
        <div style="text-align:center;padding:1.5rem">
          <div style="font-size:3rem;margin-bottom:1rem">3Ô∏è‚É£</div>
          <div style="font-size:1.1rem;font-weight:700;margin-bottom:0.5rem">Earn Rewards</div>
          <div style="color:#999;font-size:0.9rem">Get points, badges, and free refills for milestones</div>
        </div>
        
        <div style="text-align:center;padding:1.5rem">
          <div style="font-size:3rem;margin-bottom:1rem">4Ô∏è‚É£</div>
          <div style="font-size:1.1rem;font-weight:700;margin-bottom:0.5rem">Track Growth</div>
          <div style="color:#999;font-size:0.9rem">Monitor your trees with photos and updates</div>
        </div>
      </div>
    </div>
  </main>

  <script type="module" src="../main.js"></script>
  <script>
    let treeCount = 12;
    let points = 1200;
    let totalTrees = 3847;
    
    window.addEventListener('DOMContentLoaded', () => {
      updateProgress();
      initializeMap();
      initPlantingChart();
    });

    function plantTree() {
      if (points < 100) {
        showNotification('‚ùå Not enough Green Points! Earn more by refilling with LPG.');
        return;
      }
      
      // Deduct points
      points -= 100;
      document.getElementById('yourPoints').textContent = points.toLocaleString();
      
      // Increment trees
      treeCount++;
      totalTrees++;
      document.getElementById('yourTrees').textContent = treeCount;
      document.getElementById('totalTrees').textContent = totalTrees.toLocaleString();
      
      // Update progress
      updateProgress();
      
      // Add tree to map
      addTreeMarker();
      
      // Animate tree icon
      const treeIcon = document.getElementById('treeIcon');
      treeIcon.style.animation = 'none';
      setTimeout(() => {
        treeIcon.style.animation = 'treeGrow 3s ease-in-out infinite';
      }, 10);
      
      // Check for rewards
      checkRewards();
      
      // Show notification
      showNotification('üå≥ Tree planted successfully! +100 impact points earned!');
      
      // Update chart
      initPlantingChart();
    }

    function updateProgress() {
      const progress = treeCount % 15;
      const percentage = (progress / 15) * 100;
      const circumference = 2 * Math.PI * 90;
      const offset = circumference - (percentage / 100) * circumference;
      
      document.getElementById('progressCircle').style.strokeDashoffset = offset;
      document.getElementById('progressText').textContent = `${progress}/15`;
      
      // Update progress message
      const remaining = 15 - progress;
      if (remaining === 0) {
        showNotification('üéâ Congratulations! You unlocked a FREE 13kg REFILL!');
      }
    }

    function checkRewards() {
      // Check if reached 15 trees milestone
      if (treeCount === 15) {
        const reward = document.getElementById('reward15');
        reward.classList.add('unlocked');
        reward.querySelector('.reward-icon').style.animation = 'iconBounce 0.8s ease-out';
        setTimeout(() => {
          showNotification('üéÅ REWARD UNLOCKED: Free 13kg LPG Refill! Check your account.');
        }, 1000);
      }
    }

    function addTreeMarker() {
      const container = document.getElementById('treeMarkers');
      const marker = document.createElement('div');
      marker.className = 'tree-marker';
      marker.innerHTML = 'üå≤';
      
      // Random position
      const x = Math.random() * 85 + 5;
      const y = Math.random() * 85 + 5;
      marker.style.left = x + '%';
      marker.style.top = y + '%';
      
      // Add click handler
      marker.onclick = () => {
        const date = new Date();
        const coords = `${(Math.random() * 5 - 1.5).toFixed(6)}, ${(Math.random() * 5 + 36).toFixed(6)}`;
        alert(`üå≤ Tree #${treeCount}\n\nüìç Location: ${coords}\nüìÖ Planted: ${date.toLocaleDateString()}\n‚úÖ Status: Verified\nüå± Species: Indigenous Acacia\nüíß Last Watered: Today\nüì∏ Photos: 3 available`);
      };
      
      container.appendChild(marker);
    }

    function initializeMap() {
      const container = document.getElementById('treeMarkers');
      // Add existing 12 trees
      for (let i = 0; i < treeCount; i++) {
        const marker = document.createElement('div');
        marker.className = 'tree-marker';
        marker.innerHTML = 'üå≤';
        
        const x = Math.random() * 85 + 5;
        const y = Math.random() * 85 + 5;
        marker.style.left = x + '%';
        marker.style.top = y + '%';
        
        const treeNum = i + 1;
        marker.onclick = () => {
          const date = new Date(2025, 0, Math.floor(Math.random() * 30) + 1);
          const coords = `${(Math.random() * 5 - 1.5).toFixed(6)}, ${(Math.random() * 5 + 36).toFixed(6)}`;
          alert(`üå≤ Tree #${treeNum}\n\nüìç Location: ${coords}\nüìÖ Planted: ${date.toLocaleDateString()}\n‚úÖ Status: Verified\nüå± Species: Indigenous Acacia\nüíß Last Watered: ${Math.floor(Math.random() * 7)} days ago\nüì∏ Photos: ${Math.floor(Math.random() * 5) + 1} available`);
        };
        
        container.appendChild(marker);
      }
    }

    function initPlantingChart() {
      const ctx = document.getElementById('plantingChart').getContext('2d');
      
      // Clear existing chart
      const existingChart = Chart.getChart(ctx);
      if (existingChart) {
        existingChart.destroy();
      }
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'],
          datasets: [{
            label: 'Trees Planted',
            data: [0, 1, 1, 2, 1, 2, 1, 2, 1, treeCount - 11],
            backgroundColor: '#00ff88',
            borderRadius: 8
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false }
          },
          scales: {
            y: {
              beginAtZero: true,
              grid: { color: 'rgba(255,255,255,0.1)' },
              ticks: { color: '#999' }
            },
            x: {
              grid: { display: false },
              ticks: { color: '#999' }
            }
          }
        }
      });
    }

    function showNotification(message) {
      const notification = document.getElementById('notification');
      notification.textContent = message;
      notification.classList.add('show');
      
      setTimeout(() => {
        notification.classList.remove('show');
      }, 4500);
    }
  </script>
</body>
</html>
