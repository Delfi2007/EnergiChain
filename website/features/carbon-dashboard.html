<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Personal Carbon Dashboard ‚Äî EnergiChain</title>
  <link rel="stylesheet" href="../styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .impact-card {
      background: linear-gradient(135deg, rgba(0,255,136,0.1) 0%, rgba(0,200,255,0.1) 100%);
      border: 2px solid var(--accent);
      border-radius: 15px;
      padding: 2rem;
      text-align: center;
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
    }
    
    .impact-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(0,255,136,0.3);
    }
    
    .impact-card::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(0,255,136,0.1) 0%, transparent 70%);
      animation: rotate 20s linear infinite;
    }
    
    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    .impact-value {
      font-size: 3rem;
      font-weight: 800;
      background: linear-gradient(135deg, var(--accent), #00c8ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin: 1rem 0;
      position: relative;
      z-index: 1;
    }
    
    .impact-label {
      font-size: 0.9rem;
      color: #999;
      text-transform: uppercase;
      letter-spacing: 1px;
      position: relative;
      z-index: 1;
    }
    
    .comparison-section {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 2rem;
      margin: 2rem 0;
      position: relative;
    }
    
    .fuel-comparison {
      background: rgba(0,0,0,0.3);
      border: 1px solid #333;
      border-radius: 12px;
      padding: 1.5rem;
      text-align: center;
      transition: all 0.3s ease;
    }
    
    .fuel-comparison.active {
      border-color: var(--accent);
      background: rgba(0,255,136,0.05);
      transform: scale(1.05);
    }
    
    .fuel-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
      filter: drop-shadow(0 0 10px currentColor);
    }
    
    .emissions-bar {
      height: 150px;
      display: flex;
      align-items: flex-end;
      justify-content: center;
      margin: 1rem 0;
    }
    
    .emissions-fill {
      width: 60%;
      background: linear-gradient(to top, #ff0000, #ff6600);
      border-radius: 8px 8px 0 0;
      position: relative;
      animation: fillUp 1s ease-out;
    }
    
    .fuel-comparison.active .emissions-fill {
      background: linear-gradient(to top, var(--accent), #00c8ff);
    }
    
    @keyframes fillUp {
      from { height: 0; opacity: 0; }
      to { opacity: 1; }
    }
    
    .share-card {
      background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
      border: 2px solid var(--accent);
      border-radius: 20px;
      padding: 3rem;
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    
    .share-card canvas {
      max-width: 100%;
      border-radius: 10px;
      margin: 2rem 0;
    }
    
    .social-share {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: 1.5rem;
    }
    
    .social-btn {
      padding: 0.75rem 1.5rem;
      border-radius: 25px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.3s ease;
      font-size: 0.9rem;
    }
    
    .social-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }
    
    .social-btn.twitter {
      background: #1DA1F2;
      color: #fff;
    }
    
    .social-btn.facebook {
      background: #4267B2;
      color: #fff;
    }
    
    .social-btn.whatsapp {
      background: #25D366;
      color: #fff;
    }
    
    .social-btn.download {
      background: var(--accent);
      color: #000;
    }
    
    .achievement-badge {
      display: inline-block;
      padding: 0.5rem 1rem;
      background: rgba(0,255,136,0.1);
      border: 2px solid var(--accent);
      border-radius: 25px;
      margin: 0.5rem;
      font-size: 0.85rem;
      animation: badgePop 0.5s ease-out;
    }
    
    @keyframes badgePop {
      0% { transform: scale(0); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
    
    .tree-counter {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 1rem;
      margin: 2rem 0;
      font-size: 1.2rem;
    }
    
    .tree-icon {
      font-size: 2rem;
      animation: treeGrow 2s ease-in-out infinite;
    }
    
    @keyframes treeGrow {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    
    @media (max-width: 768px) {
      .comparison-section {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <header class="site-header">
    <div style="display:flex;align-items:center;gap:1rem">
      <div class="brand">EnergiChain</div>
      <span style="font-size:0.9rem;color:#666">|</span>
      <span style="font-size:0.9rem;color:#999">Carbon Impact Dashboard</span>
    </div>
    <nav>
      <a href="index.html" style="display:flex;align-items:center;gap:0.5rem">
        ‚Üê Dashboard
      </a>
    </nav>
  </header>
  
  <main style="padding:2rem;max-width:1400px;margin:0 auto">
    <!-- Header Section -->
    <div style="text-align:center;margin-bottom:3rem">
      <h1 style="font-size:2.5rem;margin-bottom:1rem;background:linear-gradient(135deg,var(--accent),#00c8ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text">
        üåç Personal Carbon Dashboard
      </h1>
      <p style="font-size:1.1rem;color:#999;line-height:1.6">
        Track your environmental impact by switching from charcoal/kerosene to clean LPG
      </p>
    </div>

    <!-- Impact Cards -->
    <div class="dashboard-grid">
      <div class="impact-card">
        <div class="impact-label">CO‚ÇÇ Saved</div>
        <div class="impact-value" id="co2Saved">798 kg</div>
        <div style="font-size:0.85rem;color:#ccc">vs Charcoal/Kerosene</div>
      </div>
      
      <div class="impact-card">
        <div class="impact-label">Trees Equivalent</div>
        <div class="impact-value" id="treesEquiv">36</div>
        <div style="font-size:0.85rem;color:#ccc">Trees Planted</div>
      </div>
      
      <div class="impact-card">
        <div class="impact-label">LPG Refills</div>
        <div class="impact-value" id="refillCount">24</div>
        <div style="font-size:0.85rem;color:#ccc">This Year</div>
      </div>
      
      <div class="impact-card">
        <div class="impact-label">Money Saved</div>
        <div class="impact-value" id="moneySaved">KES 18,400</div>
        <div style="font-size:0.85rem;color:#ccc">vs Traditional Fuels</div>
      </div>
    </div>

    <!-- Fuel Comparison -->
    <div class="action-panel" style="margin-bottom:2rem">
      <h3>‚ö° Fuel Emissions Comparison</h3>
      <p style="color:#999;margin-bottom:2rem">Compare CO‚ÇÇ emissions per 13kg LPG equivalent</p>
      
      <div class="comparison-section">
        <div class="fuel-comparison">
          <div class="fuel-icon">ü™µ</div>
          <div style="font-size:1.2rem;font-weight:700;margin-bottom:1rem">Charcoal</div>
          <div class="emissions-bar">
            <div class="emissions-fill" style="height:90%">
              <div style="position:absolute;top:-30px;left:50%;transform:translateX(-50%);font-weight:700;color:#ff0000">47 kg</div>
            </div>
          </div>
          <div style="color:#ff0000;font-weight:600">+1,560% CO‚ÇÇ</div>
        </div>
        
        <div class="fuel-comparison">
          <div class="fuel-icon">üõ¢Ô∏è</div>
          <div style="font-size:1.2rem;font-weight:700;margin-bottom:1rem">Kerosene</div>
          <div class="emissions-bar">
            <div class="emissions-fill" style="height:75%">
              <div style="position:absolute;top:-30px;left:50%;transform:translateX(-50%);font-weight:700;color:#ff6600">38 kg</div>
            </div>
          </div>
          <div style="color:#ff6600;font-weight:600">+1,242% CO‚ÇÇ</div>
        </div>
        
        <div class="fuel-comparison active">
          <div class="fuel-icon">‚ö°</div>
          <div style="font-size:1.2rem;font-weight:700;margin-bottom:1rem;color:var(--accent)">Clean LPG</div>
          <div class="emissions-bar">
            <div class="emissions-fill" style="height:20%">
              <div style="position:absolute;top:-30px;left:50%;transform:translateX(-50%);font-weight:700;color:var(--accent)">2.8 kg</div>
            </div>
          </div>
          <div style="color:var(--accent);font-weight:600">‚úì Cleanest Option</div>
        </div>
      </div>
    </div>

    <!-- Charts -->
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:2rem;margin-bottom:2rem">
      <div class="action-panel">
        <h3>üìä Monthly CO‚ÇÇ Savings Trend</h3>
        <div class="chart-container" style="height:300px">
          <canvas id="savingsChart"></canvas>
        </div>
      </div>
      
      <div class="action-panel">
        <h3>üî• Fuel Usage Breakdown</h3>
        <div class="chart-container" style="height:300px">
          <canvas id="fuelChart"></canvas>
        </div>
      </div>
    </div>

    <!-- Achievements -->
    <div class="action-panel" style="margin-bottom:2rem">
      <h3>üèÜ Environmental Achievements</h3>
      <div style="margin-top:1.5rem;text-align:center">
        <div class="achievement-badge">üå± First Clean Refill</div>
        <div class="achievement-badge">‚ôªÔ∏è 10 Refills Milestone</div>
        <div class="achievement-badge">üå≥ 100kg CO‚ÇÇ Saved</div>
        <div class="achievement-badge">üíö 500kg CO‚ÇÇ Saved</div>
        <div class="achievement-badge">üåç Climate Champion</div>
        <div class="achievement-badge">‚≠ê Year of Clean Energy</div>
      </div>
      
      <div class="tree-counter">
        <span class="tree-icon">üå≤</span>
        <span style="font-weight:700;color:var(--accent);font-size:1.5rem">36 trees</span>
        <span style="color:#999">= Your carbon offset impact</span>
      </div>
    </div>

    <!-- Shareable Report -->
    <div class="action-panel">
      <h3>üì§ Share Your Impact</h3>
      <button onclick="generateReport()" style="padding:1rem 2rem;font-size:1.1rem;margin:1rem 0">
        üé® Generate Shareable Report
      </button>
      
      <div id="shareSection" style="display:none;margin-top:2rem">
        <div class="share-card" id="shareCard">
          <div style="position:absolute;top:0;left:0;right:0;height:100px;background:linear-gradient(135deg,var(--accent),#00c8ff);opacity:0.2"></div>
          
          <div style="position:relative;z-index:1">
            <div style="font-size:2rem;font-weight:800;margin-bottom:1rem">üåç My Carbon Impact</div>
            <div style="font-size:1.1rem;color:#999;margin-bottom:2rem">Powered by EnergiChain</div>
            
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:2rem;margin-bottom:2rem">
              <div style="background:rgba(0,0,0,0.3);padding:2rem;border-radius:15px;border:2px solid var(--accent)">
                <div style="font-size:3rem;font-weight:800;color:var(--accent)" id="shareC02">798 kg</div>
                <div style="font-size:1rem;color:#ccc;margin-top:0.5rem">CO‚ÇÇ Saved</div>
              </div>
              <div style="background:rgba(0,0,0,0.3);padding:2rem;border-radius:15px;border:2px solid var(--accent)">
                <div style="font-size:3rem;font-weight:800;color:var(--accent)" id="shareTrees">36</div>
                <div style="font-size:1rem;color:#ccc;margin-top:0.5rem">Trees Equivalent</div>
              </div>
            </div>
            
            <canvas id="shareChart" width="600" height="200"></canvas>
            
            <div style="margin-top:2rem;padding:1.5rem;background:rgba(0,255,136,0.1);border-radius:12px;border:1px solid var(--accent)">
              <div style="font-size:1.2rem;font-weight:700;color:var(--accent);margin-bottom:0.5rem">
                "I'm fighting climate change with every LPG refill!"
              </div>
              <div style="font-size:0.9rem;color:#999">
                Join me in reducing carbon emissions ‚Ä¢ energichain.io
              </div>
            </div>
            
            <div style="margin-top:2rem;font-size:0.8rem;color:#666">
              Blockchain TX: 0x9a47b...3c8f2 ‚Ä¢ Generated on ${new Date().toLocaleDateString()}
            </div>
          </div>
        </div>
        
        <div class="social-share">
          <button class="social-btn twitter" onclick="shareTwitter()">
            üê¶ Share on Twitter
          </button>
          <button class="social-btn facebook" onclick="shareFacebook()">
            üìò Share on Facebook
          </button>
          <button class="social-btn whatsapp" onclick="shareWhatsApp()">
            üí¨ Share on WhatsApp
          </button>
          <button class="social-btn download" onclick="downloadReport()">
            üì• Download Image
          </button>
        </div>
      </div>
    </div>

    <!-- Impact Breakdown -->
    <div class="action-panel" style="margin-top:2rem">
      <h3>üìà Detailed Impact Analysis</h3>
      <div style="display:grid;gap:1rem;margin-top:1rem">
        <div style="display:flex;justify-content:space-between;padding:1rem;background:rgba(0,0,0,0.2);border-radius:8px">
          <span style="color:#999">Charcoal Avoided</span>
          <span style="font-weight:700;color:var(--accent)">342 kg</span>
        </div>
        <div style="display:flex;justify-content:space-between;padding:1rem;background:rgba(0,0,0,0.2);border-radius:8px">
          <span style="color:#999">Kerosene Avoided</span>
          <span style="font-weight:700;color:var(--accent)">156 liters</span>
        </div>
        <div style="display:flex;justify-content:space-between;padding:1rem;background:rgba(0,0,0,0.2);border-radius:8px">
          <span style="color:#999">Deforestation Prevented</span>
          <span style="font-weight:700;color:var(--accent)">0.8 hectares</span>
        </div>
        <div style="display:flex;justify-content:space-between;padding:1rem;background:rgba(0,0,0,0.2);border-radius:8px">
          <span style="color:#999">Health Cost Savings</span>
          <span style="font-weight:700;color:var(--accent)">KES 12,300</span>
        </div>
        <div style="display:flex;justify-content:space-between;padding:1rem;background:rgba(0,0,0,0.2);border-radius:8px">
          <span style="color:#999">Time Saved (vs gathering firewood)</span>
          <span style="font-weight:700;color:var(--accent)">96 hours</span>
        </div>
      </div>
    </div>
  </main>

  <script type="module" src="../main.js"></script>
  <script>
    // Initialize charts on page load
    window.addEventListener('DOMContentLoaded', () => {
      initSavingsChart();
      initFuelChart();
      animateCounters();
    });

    function animateCounters() {
      // Animate the impact values on load
      const co2Element = document.getElementById('co2Saved');
      const treesElement = document.getElementById('treesEquiv');
      const refillElement = document.getElementById('refillCount');
      
      animateValue(co2Element, 0, 798, 2000, ' kg');
      animateValue(treesElement, 0, 36, 2000, '');
      animateValue(refillElement, 0, 24, 2000, '');
    }

    function animateValue(element, start, end, duration, suffix = '') {
      const range = end - start;
      const increment = range / (duration / 16);
      let current = start;
      
      const timer = setInterval(() => {
        current += increment;
        if (current >= end) {
          current = end;
          clearInterval(timer);
        }
        element.textContent = Math.floor(current) + suffix;
      }, 16);
    }

    function initSavingsChart() {
      const ctx = document.getElementById('savingsChart').getContext('2d');
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'],
          datasets: [{
            label: 'CO‚ÇÇ Saved (kg)',
            data: [45, 68, 72, 81, 89, 95, 78, 84, 91, 95],
            borderColor: '#00ff88',
            backgroundColor: 'rgba(0,255,136,0.1)',
            tension: 0.4,
            fill: true,
            borderWidth: 3
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false }
          },
          scales: {
            y: {
              beginAtZero: true,
              grid: { color: 'rgba(255,255,255,0.1)' },
              ticks: { color: '#999' }
            },
            x: {
              grid: { color: 'rgba(255,255,255,0.1)' },
              ticks: { color: '#999' }
            }
          }
        }
      });
    }

    function initFuelChart() {
      const ctx = document.getElementById('fuelChart').getContext('2d');
      new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: ['Clean LPG', 'Avoided Charcoal', 'Avoided Kerosene'],
          datasets: [{
            data: [312, 342, 156],
            backgroundColor: ['#00ff88', '#ff0000', '#ff6600'],
            borderWidth: 0
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'bottom',
              labels: { color: '#999', padding: 15 }
            }
          }
        }
      });
    }

    function generateReport() {
      // Show share section
      document.getElementById('shareSection').style.display = 'block';
      
      // Update share card values
      document.getElementById('shareC02').textContent = document.getElementById('co2Saved').textContent;
      document.getElementById('shareTrees').textContent = document.getElementById('treesEquiv').textContent;
      
      // Generate mini chart for share card
      const canvas = document.getElementById('shareChart');
      const ctx = canvas.getContext('2d');
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'],
          datasets: [{
            label: 'Monthly CO‚ÇÇ Saved',
            data: [45, 68, 72, 81, 89, 95, 78, 84, 91, 95],
            backgroundColor: '#00ff88',
            borderRadius: 6
          }]
        },
        options: {
          responsive: false,
          plugins: {
            legend: { display: false }
          },
          scales: {
            y: {
              beginAtZero: true,
              grid: { color: 'rgba(255,255,255,0.1)' },
              ticks: { color: '#999', font: { size: 10 } }
            },
            x: {
              grid: { display: false },
              ticks: { color: '#999', font: { size: 10 } }
            }
          }
        }
      });
      
      // Scroll to share section
      document.getElementById('shareSection').scrollIntoView({ behavior: 'smooth' });
    }

    function downloadReport() {
      const shareCard = document.getElementById('shareCard');
      
      // Use html2canvas if available, otherwise show message
      if (typeof html2canvas !== 'undefined') {
        html2canvas(shareCard).then(canvas => {
          const link = document.createElement('a');
          link.download = `carbon-impact-${Date.now()}.png`;
          link.href = canvas.toDataURL();
          link.click();
        });
      } else {
        // Simple canvas method
        alert('üì∏ Report ready! Right-click the card above and select "Save image as..."');
      }
    }

    function shareTwitter() {
      const text = `I've saved 798kg of CO‚ÇÇ by switching to clean LPG! That's equivalent to planting 36 trees üå≥ Join me in fighting climate change. #CleanEnergy #CarbonOffset #EnergiChain`;
      const url = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`;
      window.open(url, '_blank', 'width=600,height=400');
    }

    function shareFacebook() {
      const url = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent('https://energichain.io')}&quote=${encodeURIComponent('I saved 798kg of CO‚ÇÇ with EnergiChain! Join the clean energy revolution.')}`;
      window.open(url, '_blank', 'width=600,height=400');
    }

    function shareWhatsApp() {
      const text = `üåç I've saved 798kg of CO‚ÇÇ by switching to clean LPG!\n\nThat's like planting 36 trees üå≥\n\nJoin me in fighting climate change with EnergiChain!\n\n‚úÖ Cleaner air\n‚úÖ Lower emissions\n‚úÖ Better health\n\nLearn more: https://energichain.io`;
      const url = `https://wa.me/?text=${encodeURIComponent(text)}`;
      window.open(url, '_blank');
    }
  </script>
</body>
</html>
